The refactoring is complete. Here's a summary of the changes:

## Summary of Changes

### Added: `parseDateRange()` utility in `src/utils/date.ts`
- New function that encapsulates the common date range parsing pattern
- Handles `--since`, `--until`, and `--days` flags with consistent validation
- Supports configurable defaults and optional same-day range extension
- Returns a typed result object with parsed dates in both Date and ISO string formats

### Refactored: `src/commands/transactions.ts`
- Replaced ~40 lines of manual date parsing/validation with a single `parseDateRange()` call
- Reduced cognitive overhead; the intent is now clearer
- Lines reduced: ~40 → ~10

### Refactored: `src/commands/query.ts`
- Removed the private `parseDateFlag()` method
- Replaced manual date parsing and validation with `parseDateRange()`
- Lines reduced: ~15 → ~8

### Benefits
1. **DRY**: Single source of truth for date range parsing
2. **Consistency**: Same validation and error messages across commands
3. **Maintainability**: Future changes only need to be made in one place
4. **Extensibility**: Easy to add date range support to new commands
5. **No breaking changes**: Behavior is identical; all 47 tests pass

SUCCESS
